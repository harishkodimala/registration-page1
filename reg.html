<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>REGISTRATION FORM</title>
  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbzYpIe068pw75FY1QX4dC6_fLr-KrN5ULeTfRBZrIq15hkaxCREL5tqW8buBOY1wKh9/exec"; // replace with your Apps Script Web App URL

    async function handleSubmit(event) {
      event.preventDefault();
      if (!validateForm()) return;

      const form = document.forms["regForm"];

      const data = {
        fname: form["fname"].value,
        lname: form["lname"].value,
        pw: form["pw"].value,
        email: form["ename"].value,
        phone: form["phn"].value,
        gender: form["sex"].value,
        dob: form["dob"].value + "-" + form["dob1"].value + "-" + form["dob3"].value,
        languages: Array.from(form.querySelectorAll('input[name="hb"]:checked')).map(cb => cb.value).join(", "),
        address: form["add"].value
      };

      try {
        let res = await fetch(scriptURL, {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        });

        if (res.ok) {
          alert("Form submitted successfully!");
          form.reset();
        } else {
          alert("Error submitting form.");
        }
      } catch (error) {
        alert("Error: " + error.message);
      }
    }

    function validateForm() {
      const form = document.forms["regForm"];
      const fname = form["fname"].value.trim();
      const lname = form["lname"].value.trim();
      const pw = form["pw"].value;
      const cp = form["cp"].value;
      const email = form["ename"].value.trim();
      const phone = form["phn"].value.trim();
      const terms = form["xx"].checked;

      if (!fname) { alert("First name required"); return false; }
      if (!lname) { alert("Last name required"); return false; }
      if (!pw) { alert("Password required"); return false; }
      if (pw !== cp) { alert("Passwords do not match"); return false; }
      if (!email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) { alert("Invalid email"); return false; }
      if (!/^\d{10}$/.test(phone)) { alert("Invalid phone"); return false; }
      if (!terms) { alert("Accept Terms"); return false; }

      return true;
    }
  </script>
</head>
<body bgcolor="cyan">
  <h2 align="center">ONLINE REGISTRATION</h2>
  <hr />

  <form name="regForm" onsubmit="handleSubmit(event)">
    <table align="center" cellspacing="20">
      <tr><td align="right">First name:* </td><td><input type="text" name="fname" /></td></tr>
      <tr><td align="right">Last name:* </td><td><input type="text" name="lname" /></td></tr>
      <tr><td align="right">Password:* </td><td><input type="password" name="pw" /></td></tr>
      <tr><td align="right">Confirm Password:* </td><td><input type="password" name="cp" /></td></tr>
      <tr><td align="right">Gender:</td>
        <td>
          <input type="radio" name="sex" value="Male" /> Male
          <input type="radio" name="sex" value="Female" /> Female
        </td>
      </tr>
      <tr><td align="right">DOB:</td>
        <td>
          <select name="dob"><option>Month</option><option>JAN</option><option>FEB</option></select>
          <select name="dob1"><option>Day</option><option>01</option><option>02</option></select>
          <select name="dob3"><option>Year</option><option>2005</option><option>2006</option></select>
        </td>
      </tr>
      <tr><td align="right">Email:* </td><td><input type="text" name="ename" /></td></tr>
      <tr><td align="right">Phone:* </td><td><input type="text" name="phn" /></td></tr>
      <tr><td align="right">Languages:</td>
        <td>
          <input type="checkbox" name="hb" value="English" /> English
          <input type="checkbox" name="hb" value="Telugu" /> Telugu
        </td>
      </tr>
      <tr><td align="right">Address:* </td><td><textarea name="add"></textarea></td></tr>
      <tr><td></td><td><input type="checkbox" name="xx" /> I Agree</td></tr>
      <tr>
        <td></td>
        <td>
          <input type="submit" value="SUBMIT" />
          <input type="reset" value="RESET" />
        </td>
      </tr>
    </table>
  </form>
</body>
</html>
